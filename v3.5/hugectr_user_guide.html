<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction to HugeCTR &mdash; Merlin HugeCTR  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/mystnb.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script >let toggleHintShow = 'Click to show';</script>
        <script >let toggleHintHide = 'Click to hide';</script>
        <script >let toggleOpenOnPrint = 'true';</script>
        <script src="_static/togglebutton.js"></script>
        <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="HugeCTR Core Features" href="hugectr_core_features.html" />
    <link rel="prev" title="Merlin HugeCTR" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Merlin HugeCTR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#about-hugectr">About HugeCTR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-and-building-hugectr">Installing and Building HugeCTR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tools">Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hugectr_core_features.html">Core Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="hugectr_feature_details_intro.html">Features in Detail</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/index.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/multi-modal-data/index.html">Multi-modal Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional_resources.html">Additional Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Merlin HugeCTR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Introduction to HugeCTR</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="introduction-to-hugectr">
<h1>Introduction to HugeCTR<a class="headerlink" href="#introduction-to-hugectr" title="Permalink to this headline"></a></h1>
<div class="section" id="about-hugectr">
<h2>About HugeCTR<a class="headerlink" href="#about-hugectr" title="Permalink to this headline"></a></h2>
<p>HugeCTR is a GPU-accelerated framework designed to distribute training across multiple GPUs and nodes and estimate click-through rates (CTRs). HugeCTR supports model-parallel embedding tables and data-parallel neural networks and their variants such as <a class="reference external" href="https://arxiv.org/abs/1606.07792">Wide and Deep Learning (WDL)</a>, <a class="reference external" href="https://arxiv.org/abs/1708.05123">Deep Cross Network (DCN)</a>, <a class="reference external" href="https://arxiv.org/abs/1703.04247">DeepFM</a>, and <a class="reference external" href="https://ai.facebook.com/blog/dlrm-an-advanced-open-source-deep-learning-recommendation-model/">Deep Learning Recommendation Model (DLRM)</a>. HugeCTR is a component of <a class="reference external" href="https://developer.nvidia.com/nvidia-merlin#getstarted">NVIDIA Merlin Open Beta</a>. NVIDIA Merlin is used for building large-scale recommender systems, which require massive datasets to train, particularly for deep learning based solutions.</p>
<p><br><img alt="_images/merlin_arch.png" src="_images/merlin_arch.png" /></br></p>
<div align=center>Fig. 1: Merlin Architecture</div>
<p><br></br></p>
<p>To prevent data loading from becoming a major bottleneck during training, HugeCTR contains a dedicated data reader that is inherently asynchronous and multi-threaded. It will read a batched set of data records in which each record consists of high-dimensional, extremely sparse, or categorical features. Each record can also include dense numerical features, which can be fed directly to the fully connected layers. An embedding layer is used to compress the sparse input features to lower-dimensional, dense embedding vectors. There are three GPU-accelerated embedding stages:</p>
<ul class="simple">
<li><p>Table lookup</p></li>
<li><p>Weight reduction within each slot</p></li>
<li><p>Weight concatenation across the slots</p></li>
</ul>
<p>To enable large embedding training, the embedding table in HugeCTR is model parallel and distributed across all GPUs in a homogeneous cluster, which consists of multiple nodes. Each GPU has its own:</p>
<ul class="simple">
<li><p>feed-forward neural network (data parallelism) to estimate CTRs.</p></li>
<li><p>hash table to make the data preprocessing easier and enable dynamic insertion.</p></li>
</ul>
<p>Embedding initialization is not required before training takes place since the input training data are hash values (64-bit signed integer type) instead of original indices. A pair of &lt;key,value&gt; (random small weight) will be inserted during runtime only when a new key appears in the training data and the hash table cannot find it.</p>
<a class="reference internal image-reference" href="_images/fig1_hugectr_arch.png"><img alt="_images/fig1_hugectr_arch.png" class="align-center" src="_images/fig1_hugectr_arch.png" style="width: 781px;" /></a>
<div align=center>Fig. 2: HugeCTR Architecture</div>
<p><br></br></p>
<a class="reference internal image-reference" href="_images/fig2_embedding_mlp.png"><img alt="Embedding architecture" class="align-center" src="_images/fig2_embedding_mlp.png" style="width: 500px;" /></a>
<div align=center>Fig. 3: Embedding Architecture</div>
<p><br></br></p>
<a class="reference internal image-reference" href="_images/fig3_embedding_mech.png"><img alt="_images/fig3_embedding_mech.png" class="align-center" src="_images/fig3_embedding_mech.png" style="width: 640px;" /></a>
<div align=center>Fig. 4: Embedding Mechanism</div>
<p><br></br></p>
</div>
<div class="section" id="installing-and-building-hugectr">
<h2>Installing and Building HugeCTR<a class="headerlink" href="#installing-and-building-hugectr" title="Permalink to this headline"></a></h2>
<p>You can either install HugeCTR easily using the Merlin Docker image in NGC, or build HugeCTR from scratch using various build options if you’re an advanced user.</p>
<div class="section" id="compute-capability">
<h3>Compute Capability<a class="headerlink" href="#compute-capability" title="Permalink to this headline"></a></h3>
<p>We support the following compute capabilities:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Compute Capability</th>
<th>GPU</th>
<th><a href="#building-hugectr-from-scratch">SM</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>6.0</td>
<td>NVIDIA P100 (Pascal)</td>
<td>60</td>
</tr>
<tr>
<td>7.0</td>
<td>NVIDIA V100 (Volta)</td>
<td>70</td>
</tr>
<tr>
<td>7.5</td>
<td>NVIDIA T4 (Turing)</td>
<td>75</td>
</tr>
<tr>
<td>8.0</td>
<td>NVIDIA A100 (Ampere)</td>
<td>80</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="installing-hugectr-using-ngc-containers">
<h3>Installing HugeCTR Using NGC Containers<a class="headerlink" href="#installing-hugectr-using-ngc-containers" title="Permalink to this headline"></a></h3>
<p>All NVIDIA Merlin components are available as open source projects. However, a more convenient way to utilize these components is by using our Merlin NGC containers. These containers allow you to package your software application, libraries, dependencies, and runtime compilers in a self-contained environment. When installing HugeCTR using NGC containers, the application environment remains portable, consistent, reproducible, and agnostic to the underlying host system’s software configuration.</p>
<p>HugeCTR is included in the Merlin Docker containers that are available from the <a class="reference external" href="https://catalog.ngc.nvidia.com/containers">NVIDIA container repository</a>.
You can query the collection for containers that <a class="reference external" href="https://catalog.ngc.nvidia.com/containers?filters=&amp;orderBy=scoreDESC&amp;query=label:%22HugeCTR%22">match the HugeCTR label</a>.
The following table also identifies the containers:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Container Name</th>
<th>Container Location</th>
<th>Functionality</th>
</tr>
</thead>
<tbody>
<tr>
<td>merlin-inference</td>
<td>https://catalog.ngc.nvidia.com/orgs/nvidia/teams/merlin/containers/merlin-inference</td>
<td>NVTabular, HugeCTR, and Triton Inference</td>
</tr>
<tr>
<td>merlin-training</td>
<td>https://catalog.ngc.nvidia.com/orgs/nvidia/teams/merlin/containers/merlin-training</td>
<td>NVTabular and HugeCTR</td>
</tr>
<tr>
<td>merlin-tensorflow-training</td>
<td>https://catalog.ngc.nvidia.com/orgs/nvidia/teams/merlin/containers/merlin-tensorflow-training</td>
<td>NVTabular, TensorFlow, and HugeCTR Tensorflow Embedding plugin</td>
</tr>
</tbody>
</table>
<p>To use these Docker containers, you’ll first need to install the <a class="reference external" href="https://github.com/NVIDIA/nvidia-docker">NVIDIA Container Toolkit</a> to provide GPU support for Docker. You can use the NGC links referenced in the table above to obtain more information about how to launch and run these containers.</p>
<p>The following sample command pulls and starts the Merlin Training container:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the container in interactive mode</span>
$ docker run --gpus<span class="o">=</span>all --rm -it --cap-add SYS_NICE nvcr.io/nvidia/merlin/merlin-training:22.04
</pre></div>
</div>
</div>
<div class="section" id="building-hugectr-from-scratch">
<h3>Building HugeCTR from Scratch<a class="headerlink" href="#building-hugectr-from-scratch" title="Permalink to this headline"></a></h3>
<p>To build HugeCTR from scratch, refer to <a class="reference internal" href="hugectr_contributor_guide.html#build-hugectr-from-source"><span class="std std-doc">Build HugeCTR from source code</span></a>.</p>
</div>
</div>
<div class="section" id="tools">
<h2>Tools<a class="headerlink" href="#tools" title="Permalink to this headline"></a></h2>
<p>We currently support the following tools:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#generating-synthetic-data-and-benchmarks"><span class="std std-doc">Data Generator</span></a>: A configurable data generator, which is available from the Python interface, can be used to generate a synthetic dataset for benchmarking and research purposes.</p></li>
<li><p><a class="reference internal" href="#downloading-and-preprocessing-datasets"><span class="std std-doc">Preprocessing Script</span></a>: We provide a set of scripts that form a template implementation to demonstrate how complex datasets, such as the original Criteo dataset, can be converted into HugeCTR using supported dataset formats such as Norm and RAW. It’s used in all of our samples to prepare the data and train various recommender models.</p></li>
</ul>
<div class="section" id="generating-synthetic-data-and-benchmarks">
<h3>Generating Synthetic Data and Benchmarks<a class="headerlink" href="#generating-synthetic-data-and-benchmarks" title="Permalink to this headline"></a></h3>
<p>The <a class="reference internal" href="api/python_interface.html#norm"><span class="std std-doc">Norm</span></a> (with Header) and <a class="reference internal" href="api/python_interface.html#raw"><span class="std std-doc">Raw</span></a> (without Header) datasets can be generated with <a class="reference internal" href="api/python_interface.html#datagenerator"><span class="std std-doc">hugectr.tools.DataGenerator</span></a>. For categorical features, you can configure the probability distribution to be uniform or power-law within <a class="reference internal" href="api/python_interface.html#datageneratorparams-class"><span class="std std-doc">hugectr.tools.DataGeneratorParam</span></a>. The default distribution is power law with alpha = 1.2.</p>
<ul class="simple">
<li><p>Generate the <code class="docutils literal notranslate"><span class="pre">Norm</span></code> dataset for DCN and start training the HugeCTR model: <br></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 ../tools/data_generator/dcn_norm_generate_train.py
</pre></div>
</div>
<ul class="simple">
<li><p>Generate the <code class="docutils literal notranslate"><span class="pre">Norm</span></code> dataset for WDL and start training the HugeCTR model: <br></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 ../tools/data_generator/wdl_norm_generate_train.py
</pre></div>
</div>
<ul class="simple">
<li><p>Generate the <code class="docutils literal notranslate"><span class="pre">Raw</span></code> dataset for DLRM and start training the HugeCTR model: <br></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 ../tools/data_generator/dlrm_raw_generate_train.py
</pre></div>
</div>
<ul class="simple">
<li><p>Generate the <code class="docutils literal notranslate"><span class="pre">Parquet</span></code> dataset for DCN and start training the HugeCTR model: <br></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 ../tools/data_generator/dcn_parquet_generate_train.py
</pre></div>
</div>
</div>
<div class="section" id="downloading-and-preprocessing-datasets">
<h3>Downloading and Preprocessing Datasets<a class="headerlink" href="#downloading-and-preprocessing-datasets" title="Permalink to this headline"></a></h3>
<p>Download the Criteo 1TB Click Logs dataset using <code class="docutils literal notranslate"><span class="pre">HugeCTR/tools/preprocess.sh</span></code> and preprocess it to train the DCN. The <code class="docutils literal notranslate"><span class="pre">file_list.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">file_list_test.txt</span></code>, and preprocessed data files are available within the <code class="docutils literal notranslate"><span class="pre">criteo_data</span></code> directory. For more information, refer to the <a class="reference external" href="https://github.com/NVIDIA-Merlin/HugeCTR/tree/master/samples">samples</a> directory on GitHub.</p>
<p>For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> tools <span class="c1"># assume that the downloaded dataset is here</span>
$ bash preprocess.sh <span class="m">1</span> criteo_data pandas <span class="m">1</span> <span class="m">0</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Merlin HugeCTR" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hugectr_core_features.html" class="btn btn-neutral float-right" title="HugeCTR Core Features" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, NVIDIA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v3.5
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="hugectr_user_guide.html">v3.5</a></dd>
      <dd><a href="../v3.6/hugectr_user_guide.html">v3.6</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="../master/hugectr_user_guide.html">master</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>